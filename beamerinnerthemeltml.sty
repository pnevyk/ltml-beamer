\mode<presentation>

% REQUIREMENTS

\RequirePackage{graphicx}
\RequirePackage{calc}
\RequirePackage{relsize}

% SETTINGS

% title page

\defbeamertemplate*{title page}{ltml}
{
    \begin{center}
        \vfill

        \vspace{15mm}

        \begin{beamercolorbox}{title}
            \begin{center}
                \usebeamerfont*{title}\inserttitle
            \end{center}
        \end{beamercolorbox}

        \ifx\insertsubtitle\empty
        \else
            \begin{beamercolorbox}{subtitle}
                \begin{center}
                    \usebeamerfont*{subtitle}\insertsubtitle
                \end{center}
            \end{beamercolorbox}
        \fi

        \begin{beamercolorbox}{author}
            \begin{center}
                \usebeamerfont*{author}\insertauthor
            \end{center}
        \end{beamercolorbox}

        \begin{beamercolorbox}{institute}
            \begin{center}
                \usebeamerfont*{institute}{Let's talk ML in Prague}
            \end{center}
        \end{beamercolorbox}

        \vspace{-4mm}

        \begin{beamercolorbox}{date}
            \begin{center}
                \usebeamerfont*{date}\insertdate
            \end{center}
        \end{beamercolorbox}

        \ifx\insertsubtitle\empty\else\vspace{-12mm}\fi

        \vfill
    \end{center}

    \newlength\bottomstripheight
    \setlength{\bottomstripheight}{3.3mm}

    % "line height" of one line
    \newsavebox{\linebox}
    \savebox{\linebox}{\parbox{\textwidth}{\usebeamerfont*{title}Lorem}}
    \newlength\lheight
    \setlength{\lheight}{\ht\linebox}

    % "line height" of a paragraph box (potentially multiline) with inserted title
    \newsavebox{\tbox}
    \savebox{\tbox}{\parbox{\textwidth}{\usebeamerfont*{title}\inserttitle}}
    \newlength\theight
    \setlength{\theight}{\ht\tbox}

    \ifdim\theight>\lheight \vspace{-10mm} \else \vspace{-1mm} \fi%
    \noindent\mbox{%
    \textcolor{ltmlblack}{\hspace{-\beamer@leftmargin}%
    \rule{\beamer@leftmargin + 0.7\textwidth + \beamer@rightmargin}{\bottomstripheight}}%
    \includegraphics[width=0.3\textwidth]{logo}}
}

\newlength\ftwidth
\defbeamertemplate*{frametitle}{ltml}
{
    \vspace{0.2cm}

    \begin{beamercolorbox}{frametitle}
        \settowidth{\ftwidth}{\insertframetitle}
        % automatically resize the font size if the title would overlap
        \usebeamerfont*{frametitle}{\ifdim\ftwidth>\textwidth \raisebox{2pt}[\height][\depth]{\smaller[2]{\insertframetitle}} \else \insertframetitle \fi}%
    \end{beamercolorbox}

    \vspace{-0.3cm}

    \noindent\textcolor{ltmlgray}{\rule{\textwidth}{0.5pt}}
}

% bigger space under items
\newlength{\itemmargin}
\setlength{\itemmargin}{0.3\baselineskip}

\let\olditemize\itemize
\let\oldenditemize\enditemize
\renewenvironment{itemize}{\olditemize\addtolength{\itemsep}{\itemmargin}}{\oldenditemize}

\let\oldenumerate\enumerate
\let\oldendenumerate\endenumerate
\renewenvironment{enumerate}{\oldenumerate\addtolength{\itemsep}{\itemmargin}}{\oldendenumerate}

\mode<all>
